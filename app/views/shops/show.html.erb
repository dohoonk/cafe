<%= render "/layouts/google" %>

<h1>Shops</h1>
<%= image_tag @shop.cafeimg_url(:xlarge).to_s %>
<br>
<%= @shop.name %>
<br>
<%= @shop.address %>
<br>
<%= @shop.website %>
<br>
<%= @shop.phone_number %>
<hr>
<!-- likes -->
<% if @shop_like.present? && @shop_like.persisted? %>
  <%= link_to "Un-Like", shop_shop_like_path(@shop, @shop_like), method: :delete %>
<% else %>
  <%= link_to "Like", shop_shop_likes_path(@shop), method: :post %>
<% end %>

<!-- edit/delete -->
<% if can? :edit, @shop %>
  <%= link_to "Edit", edit_shop_path(@shop) %>
<% end %>
<% if can? :delete, @shop %>
  <%= link_to "Delete", shop_path(@shop), method: :delete %>
<% end %>

<hr>

<% if @shop.longitude && @shop.latitude %>
<div style='width: 500px;'>
  <div id="map" style='width: 500px; height: 350px;'></div>
</div>
<% end %>
<script>
 handler = Gmaps.build('Google');
 handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
   markers = handler.addMarkers([
      {
       "lat": <%= @shop.latitude %>,
       "lng": <%= @shop.longitude %>,
       "picture": {
         "url": "http://orig13.deviantart.net/4351/f/2010/178/f/6/free_jake_icon_by_picklecheesepie.gif",
         "width":  50,
         "height": 50
       },
     }
   ]);
   handler.bounds.extendWith(markers);
   handler.fitMapToBounds();
 });

 </script>

 <%= render "comments/form" %>
 <%= render "comments/show" %>
